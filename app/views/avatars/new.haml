.row.padding-for-small
  - if current_user.avatar.present?
    .medium-6.columns
      %h3= t('avatars.new.current_avatar')
      = avatar_for current_user
  .medium-6.columns
    = form_for @avatar, url: avatar_path, remote: true, authenticity_token: true do |f|
      = error_messages_for f.object
      .field
        = f.label :file
        = f.file_field :file, id: 'uploaded_file'
        .callout.warning.hide#unsupported_format
          = t('.unsupported_format')
        .callout.warning.hide#file_too_big
          = t('file_too_big', size: '5 MB')
      .actions
        = f.submit t('avatars.new.submit'), class: 'button primary expanded', id: 'upload_submit'

:javascript
  document.getElementById('uploaded_file').addEventListener('change', function(e) {
    var extension = e.target.value.split('.').pop().toLowerCase();
    var tooBigDiv = document.getElementById('file_too_big');
    var formatWarningDiv = document.getElementById('unsupported_format');
    var submitButton = document.getElementById('upload_submit');
    var valid = true;
    if (extension) {
      if (!['jpg', 'jpeg', 'gif', 'png', 'svg'].includes(extension)) {
        formatWarningDiv.classList.remove('hide');
        valid = false;
      }
      if (e.target.files && e.target.files[0].size > 5242880) {
        tooBigDiv.classList.remove('hide');
        valid = false;
      }
      if (valid) {
        tooBigDiv.classList.add('hide');
        formatWarningDiv.classList.add('hide');
      }
      submitButton.disabled = !valid;
    }
  }, false);
